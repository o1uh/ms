2025-05-29 22:59:24,781 - ServerApp - INFO - Запуск серверного приложения...
2025-05-29 22:59:24,782 - ServerApp - INFO - Сервер запущен и слушает на 127.0.0.1:65432
2025-05-29 22:59:24,782 - ServerApp - INFO - Для остановки сервера нажмите Ctrl+C в этой консоли.
2025-05-29 22:59:28,235 - ServerApp - INFO - Новое подключение от ('127.0.0.1', 53056)
2025-05-29 22:59:28,254 - ServerApp - INFO - Успешное подключение к базе данных PostgreSQL.
2025-05-29 22:59:31,523 - ServerApp - DEBUG - Получено от ('127.0.0.1', 53056) (аутентификация): {"type": "login", "payload": {"username": "1111", "password": "1111"}}
2025-05-29 22:59:31,684 - ServerApp - INFO - Клиент ('127.0.0.1', 53056) аутентифицирован как 1111 (ID: 1)
2025-05-29 22:59:31,684 - ServerApp - INFO - Пользователь ID 1 запросил список чатов.
2025-05-29 22:59:31,687 - ServerApp - DEBUG - Для user_id 1 найдено 6 чатов.
2025-05-29 22:59:31,687 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_list", "payload": {}}
2025-05-29 22:59:31,687 - ServerApp - INFO - Пользователь ID 1 запросил список чатов.
2025-05-29 22:59:31,688 - ServerApp - DEBUG - Для user_id 1 найдено 6 чатов.
2025-05-29 22:59:32,836 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_history", "payload": {"chat_id": 1}}
2025-05-29 22:59:32,836 - ServerApp - INFO - User_id 1 запросил историю для чата ID 1.
2025-05-29 22:59:32,836 - ServerApp - DEBUG - Извлечено 28 сообщений для chat_id: 1
2025-05-29 22:59:47,643 - ServerApp - INFO - Новое подключение от ('127.0.0.1', 53058)
2025-05-29 22:59:47,660 - ServerApp - INFO - Успешное подключение к базе данных PostgreSQL.
2025-05-29 22:59:50,635 - ServerApp - DEBUG - Получено от ('127.0.0.1', 53058) (аутентификация): {"type": "login", "payload": {"username": "2222", "password": "2222"}}
2025-05-29 22:59:50,793 - ServerApp - INFO - Клиент ('127.0.0.1', 53058) аутентифицирован как 2222 (ID: 2)
2025-05-29 22:59:50,794 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 22:59:50,797 - ServerApp - DEBUG - Для user_id 2 найдено 3 чатов.
2025-05-29 22:59:50,797 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 22:59:50,797 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 22:59:50,798 - ServerApp - DEBUG - Для user_id 2 найдено 3 чатов.
2025-05-29 23:00:08,339 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:08,340 - ServerApp - INFO - Пользователь ID 1 запросил список чатов.
2025-05-29 23:00:08,340 - ServerApp - DEBUG - Для user_id 1 найдено 6 чатов.
2025-05-29 23:00:10,556 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_history", "payload": {"chat_id": 1}}
2025-05-29 23:00:10,556 - ServerApp - INFO - User_id 2 запросил историю для чата ID 1.
2025-05-29 23:00:10,557 - ServerApp - DEBUG - Извлечено 28 сообщений для chat_id: 1
2025-05-29 23:00:12,562 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "222"}}
2025-05-29 23:00:12,563 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=2, content='222...'
2025-05-29 23:00:12,565 - ServerApp - DEBUG - Сообщение вставлено, ID: 102, Время БД: 2025-05-29T23:00:12.563209+07:00
2025-05-29 23:00:12,566 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:12.563209+07:00
2025-05-29 23:00:12,566 - ServerApp - INFO - Сообщение ID: 102 от user_id: 2 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:12.563209+07:00).
2025-05-29 23:00:12,566 - ServerApp - INFO - Сообщение (ID: 102) от 2222 в чат 1 сохранено.
2025-05-29 23:00:12,566 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 2 - 2222): [1]
2025-05-29 23:00:12,566 - ServerApp - INFO - Доставка сообщения (ID: 102) от 2222 участнику 1111 (ID: 1) чата 1.
2025-05-29 23:00:12,576 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:12,577 - ServerApp - INFO - Пользователь ID 1 запросил список чатов.
2025-05-29 23:00:12,577 - ServerApp - DEBUG - Для user_id 1 найдено 6 чатов.
2025-05-29 23:00:16,187 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_history", "payload": {"chat_id": 1}}
2025-05-29 23:00:16,187 - ServerApp - INFO - User_id 1 запросил историю для чата ID 1.
2025-05-29 23:00:16,188 - ServerApp - DEBUG - Извлечено 29 сообщений для chat_id: 1
2025-05-29 23:00:20,497 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "1"}}
2025-05-29 23:00:20,497 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=1, content='1...'
2025-05-29 23:00:20,498 - ServerApp - DEBUG - Сообщение вставлено, ID: 103, Время БД: 2025-05-29T23:00:20.497720+07:00
2025-05-29 23:00:20,498 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:20.497720+07:00
2025-05-29 23:00:20,498 - ServerApp - INFO - Сообщение ID: 103 от user_id: 1 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:20.497720+07:00).
2025-05-29 23:00:20,498 - ServerApp - INFO - Сообщение (ID: 103) от 1111 в чат 1 сохранено.
2025-05-29 23:00:20,499 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 1 - 1111): [2]
2025-05-29 23:00:20,499 - ServerApp - INFO - Доставка сообщения (ID: 103) от 1111 участнику 2222 (ID: 2) чата 1.
2025-05-29 23:00:21,009 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "2"}}
2025-05-29 23:00:21,009 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=1, content='2...'
2025-05-29 23:00:21,010 - ServerApp - DEBUG - Сообщение вставлено, ID: 104, Время БД: 2025-05-29T23:00:21.009815+07:00
2025-05-29 23:00:21,010 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:21.009815+07:00
2025-05-29 23:00:21,010 - ServerApp - INFO - Сообщение ID: 104 от user_id: 1 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:21.009815+07:00).
2025-05-29 23:00:21,010 - ServerApp - INFO - Сообщение (ID: 104) от 1111 в чат 1 сохранено.
2025-05-29 23:00:21,010 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 1 - 1111): [2]
2025-05-29 23:00:21,010 - ServerApp - INFO - Доставка сообщения (ID: 104) от 1111 участнику 2222 (ID: 2) чата 1.
2025-05-29 23:00:21,457 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "3"}}
2025-05-29 23:00:21,457 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=1, content='3...'
2025-05-29 23:00:21,460 - ServerApp - DEBUG - Сообщение вставлено, ID: 105, Время БД: 2025-05-29T23:00:21.457670+07:00
2025-05-29 23:00:21,460 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:21.457670+07:00
2025-05-29 23:00:21,460 - ServerApp - INFO - Сообщение ID: 105 от user_id: 1 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:21.457670+07:00).
2025-05-29 23:00:21,460 - ServerApp - INFO - Сообщение (ID: 105) от 1111 в чат 1 сохранено.
2025-05-29 23:00:21,460 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 1 - 1111): [2]
2025-05-29 23:00:21,460 - ServerApp - INFO - Доставка сообщения (ID: 105) от 1111 участнику 2222 (ID: 2) чата 1.
2025-05-29 23:00:21,921 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "4"}}
2025-05-29 23:00:21,921 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=1, content='4...'
2025-05-29 23:00:21,922 - ServerApp - DEBUG - Сообщение вставлено, ID: 106, Время БД: 2025-05-29T23:00:21.921945+07:00
2025-05-29 23:00:21,922 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:21.921945+07:00
2025-05-29 23:00:21,922 - ServerApp - INFO - Сообщение ID: 106 от user_id: 1 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:21.921945+07:00).
2025-05-29 23:00:21,922 - ServerApp - INFO - Сообщение (ID: 106) от 1111 в чат 1 сохранено.
2025-05-29 23:00:21,922 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 1 - 1111): [2]
2025-05-29 23:00:21,922 - ServerApp - INFO - Доставка сообщения (ID: 106) от 1111 участнику 2222 (ID: 2) чата 1.
2025-05-29 23:00:22,433 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "5"}}
2025-05-29 23:00:22,433 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=1, content='5...'
2025-05-29 23:00:22,436 - ServerApp - DEBUG - Сообщение вставлено, ID: 107, Время БД: 2025-05-29T23:00:22.433773+07:00
2025-05-29 23:00:22,436 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:22.433773+07:00
2025-05-29 23:00:22,437 - ServerApp - INFO - Сообщение ID: 107 от user_id: 1 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:22.433773+07:00).
2025-05-29 23:00:22,437 - ServerApp - INFO - Сообщение (ID: 107) от 1111 в чат 1 сохранено.
2025-05-29 23:00:22,437 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 1 - 1111): [2]
2025-05-29 23:00:22,437 - ServerApp - INFO - Доставка сообщения (ID: 107) от 1111 участнику 2222 (ID: 2) чата 1.
2025-05-29 23:00:25,049 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "6"}}
2025-05-29 23:00:25,050 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=2, content='6...'
2025-05-29 23:00:25,050 - ServerApp - DEBUG - Сообщение вставлено, ID: 108, Время БД: 2025-05-29T23:00:25.050223+07:00
2025-05-29 23:00:25,050 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:25.050223+07:00
2025-05-29 23:00:25,050 - ServerApp - INFO - Сообщение ID: 108 от user_id: 2 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:25.050223+07:00).
2025-05-29 23:00:25,050 - ServerApp - INFO - Сообщение (ID: 108) от 2222 в чат 1 сохранено.
2025-05-29 23:00:25,051 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 2 - 2222): [1]
2025-05-29 23:00:25,051 - ServerApp - INFO - Доставка сообщения (ID: 108) от 2222 участнику 1111 (ID: 1) чата 1.
2025-05-29 23:00:25,433 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "7"}}
2025-05-29 23:00:25,434 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=2, content='7...'
2025-05-29 23:00:25,434 - ServerApp - DEBUG - Сообщение вставлено, ID: 109, Время БД: 2025-05-29T23:00:25.434272+07:00
2025-05-29 23:00:25,434 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:25.434272+07:00
2025-05-29 23:00:25,435 - ServerApp - INFO - Сообщение ID: 109 от user_id: 2 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:25.434272+07:00).
2025-05-29 23:00:25,435 - ServerApp - INFO - Сообщение (ID: 109) от 2222 в чат 1 сохранено.
2025-05-29 23:00:25,435 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 2 - 2222): [1]
2025-05-29 23:00:25,435 - ServerApp - INFO - Доставка сообщения (ID: 109) от 2222 участнику 1111 (ID: 1) чата 1.
2025-05-29 23:00:25,834 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "8"}}
2025-05-29 23:00:25,834 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=2, content='8...'
2025-05-29 23:00:25,834 - ServerApp - DEBUG - Сообщение вставлено, ID: 110, Время БД: 2025-05-29T23:00:25.834471+07:00
2025-05-29 23:00:25,834 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:25.834471+07:00
2025-05-29 23:00:25,835 - ServerApp - INFO - Сообщение ID: 110 от user_id: 2 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:25.834471+07:00).
2025-05-29 23:00:25,835 - ServerApp - INFO - Сообщение (ID: 110) от 2222 в чат 1 сохранено.
2025-05-29 23:00:25,835 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 2 - 2222): [1]
2025-05-29 23:00:25,835 - ServerApp - INFO - Доставка сообщения (ID: 110) от 2222 участнику 1111 (ID: 1) чата 1.
2025-05-29 23:00:29,194 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "9"}}
2025-05-29 23:00:29,195 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=1, content='9...'
2025-05-29 23:00:29,198 - ServerApp - DEBUG - Сообщение вставлено, ID: 111, Время БД: 2025-05-29T23:00:29.195143+07:00
2025-05-29 23:00:29,198 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:29.195143+07:00
2025-05-29 23:00:29,198 - ServerApp - INFO - Сообщение ID: 111 от user_id: 1 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:29.195143+07:00).
2025-05-29 23:00:29,199 - ServerApp - INFO - Сообщение (ID: 111) от 1111 в чат 1 сохранено.
2025-05-29 23:00:29,199 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 1 - 1111): [2]
2025-05-29 23:00:29,199 - ServerApp - INFO - Доставка сообщения (ID: 111) от 1111 участнику 2222 (ID: 2) чата 1.
2025-05-29 23:00:30,258 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "send_message_to_chat", "payload": {"chat_id": 1, "text": "0"}}
2025-05-29 23:00:30,258 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=1, sender_id=1, content='0...'
2025-05-29 23:00:30,259 - ServerApp - DEBUG - Сообщение вставлено, ID: 112, Время БД: 2025-05-29T23:00:30.258792+07:00
2025-05-29 23:00:30,259 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=1, last_message_at=2025-05-29T23:00:30.258792+07:00
2025-05-29 23:00:30,259 - ServerApp - INFO - Сообщение ID: 112 от user_id: 1 в chat_id: 1 сохранено, last_message_at обновлено (2025-05-29T23:00:30.258792+07:00).
2025-05-29 23:00:30,259 - ServerApp - INFO - Сообщение (ID: 112) от 1111 в чат 1 сохранено.
2025-05-29 23:00:30,259 - ServerApp - DEBUG - Участники чата 1 для рассылки (кроме 1 - 1111): [2]
2025-05-29 23:00:30,259 - ServerApp - INFO - Доставка сообщения (ID: 112) от 1111 участнику 2222 (ID: 2) чата 1.
2025-05-29 23:00:32,275 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:32,275 - ServerApp - INFO - Пользователь ID 1 запросил список чатов.
2025-05-29 23:00:32,276 - ServerApp - DEBUG - Для user_id 1 найдено 6 чатов.
2025-05-29 23:00:33,003 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:33,003 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 23:00:33,005 - ServerApp - DEBUG - Для user_id 2 найдено 3 чатов.
2025-05-29 23:00:34,427 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_history", "payload": {"chat_id": 1}}
2025-05-29 23:00:34,427 - ServerApp - INFO - User_id 1 запросил историю для чата ID 1.
2025-05-29 23:00:34,428 - ServerApp - DEBUG - Извлечено 39 сообщений для chat_id: 1
2025-05-29 23:00:37,707 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_history", "payload": {"chat_id": 1}}
2025-05-29 23:00:37,707 - ServerApp - INFO - User_id 2 запросил историю для чата ID 1.
2025-05-29 23:00:37,708 - ServerApp - DEBUG - Извлечено 39 сообщений для chat_id: 1
2025-05-29 23:00:51,459 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:51,459 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 23:00:51,460 - ServerApp - DEBUG - Для user_id 2 найдено 3 чатов.
2025-05-29 23:00:52,563 - ServerApp - DEBUG - Получено от 1111 (('127.0.0.1', 53056)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:52,564 - ServerApp - INFO - Пользователь ID 1 запросил список чатов.
2025-05-29 23:00:52,564 - ServerApp - DEBUG - Для user_id 1 найдено 6 чатов.
2025-05-29 23:00:54,916 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "initiate_direct_chat", "payload": {"target_username": "555"}}
2025-05-29 23:00:56,582 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:56,582 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 23:00:56,583 - ServerApp - DEBUG - Для user_id 2 найдено 3 чатов.
2025-05-29 23:00:58,625 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "initiate_direct_chat", "payload": {"target_username": "333"}}
2025-05-29 23:00:59,734 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:00:59,734 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 23:00:59,735 - ServerApp - DEBUG - Для user_id 2 найдено 3 чатов.
2025-05-29 23:01:00,929 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "initiate_direct_chat", "payload": {"target_username": "3333"}}
2025-05-29 23:01:00,930 - ServerApp - INFO - Создание нового direct чата для пользователей 2 и 3
2025-05-29 23:01:00,962 - ServerApp - INFO - Новый direct чат ID: 7 создан, участники добавлены.
2025-05-29 23:01:00,962 - ServerApp - INFO - Чат между 2222 (ID:2) и 3333 (ID:3) инициирован/найден. Chat ID: 7
2025-05-29 23:01:00,964 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_history", "payload": {"chat_id": 7}}
2025-05-29 23:01:00,964 - ServerApp - INFO - User_id 2 запросил историю для чата ID 7.
2025-05-29 23:01:00,964 - ServerApp - DEBUG - Извлечено 0 сообщений для chat_id: 7
2025-05-29 23:01:17,619 - ServerApp - INFO - Новое подключение от ('127.0.0.1', 53079)
2025-05-29 23:01:17,735 - ServerApp - INFO - Успешное подключение к базе данных PostgreSQL.
2025-05-29 23:01:19,722 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "send_message_to_chat", "payload": {"chat_id": 7, "text": "dadad"}}
2025-05-29 23:01:19,722 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=7, sender_id=2, content='dadad...'
2025-05-29 23:01:19,725 - ServerApp - DEBUG - Сообщение вставлено, ID: 113, Время БД: 2025-05-29T23:01:19.722965+07:00
2025-05-29 23:01:19,725 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=7, last_message_at=2025-05-29T23:01:19.722965+07:00
2025-05-29 23:01:19,725 - ServerApp - INFO - Сообщение ID: 113 от user_id: 2 в chat_id: 7 сохранено, last_message_at обновлено (2025-05-29T23:01:19.722965+07:00).
2025-05-29 23:01:19,725 - ServerApp - INFO - Сообщение (ID: 113) от 2222 в чат 7 сохранено.
2025-05-29 23:01:19,725 - ServerApp - DEBUG - Участники чата 7 для рассылки (кроме 2 - 2222): [3]
2025-05-29 23:01:21,291 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:01:21,291 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 23:01:21,292 - ServerApp - DEBUG - Для user_id 2 найдено 4 чатов.
2025-05-29 23:01:25,715 - ServerApp - DEBUG - Получено от ('127.0.0.1', 53079) (аутентификация): {"type": "login", "payload": {"username": "3333", "password": "3333"}}
2025-05-29 23:01:25,874 - ServerApp - INFO - Клиент ('127.0.0.1', 53079) аутентифицирован как 3333 (ID: 3)
2025-05-29 23:01:25,874 - ServerApp - INFO - Пользователь ID 3 запросил список чатов.
2025-05-29 23:01:25,877 - ServerApp - DEBUG - Для user_id 3 найдено 4 чатов.
2025-05-29 23:01:25,877 - ServerApp - DEBUG - Получено от 3333 (('127.0.0.1', 53079)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:01:25,877 - ServerApp - INFO - Пользователь ID 3 запросил список чатов.
2025-05-29 23:01:25,878 - ServerApp - DEBUG - Для user_id 3 найдено 4 чатов.
2025-05-29 23:01:27,420 - ServerApp - DEBUG - Получено от 3333 (('127.0.0.1', 53079)): {"type": "request_chat_history", "payload": {"chat_id": 7}}
2025-05-29 23:01:27,420 - ServerApp - INFO - User_id 3 запросил историю для чата ID 7.
2025-05-29 23:01:27,420 - ServerApp - DEBUG - Извлечено 1 сообщений для chat_id: 7
2025-05-29 23:01:31,395 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_history", "payload": {"chat_id": 7}}
2025-05-29 23:01:31,395 - ServerApp - INFO - User_id 2 запросил историю для чата ID 7.
2025-05-29 23:01:31,396 - ServerApp - DEBUG - Извлечено 1 сообщений для chat_id: 7
2025-05-29 23:01:32,251 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:01:32,251 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 23:01:32,252 - ServerApp - DEBUG - Для user_id 2 найдено 4 чатов.
2025-05-29 23:01:33,978 - ServerApp - DEBUG - Получено от 3333 (('127.0.0.1', 53079)): {"type": "send_message_to_chat", "payload": {"chat_id": 7, "text": "2134"}}
2025-05-29 23:01:33,979 - ServerApp - DEBUG - Попытка INSERT сообщения: chat_id=7, sender_id=3, content='2134...'
2025-05-29 23:01:33,980 - ServerApp - DEBUG - Сообщение вставлено, ID: 114, Время БД: 2025-05-29T23:01:33.979300+07:00
2025-05-29 23:01:33,980 - ServerApp - DEBUG - Попытка UPDATE chats: chat_id=7, last_message_at=2025-05-29T23:01:33.979300+07:00
2025-05-29 23:01:33,980 - ServerApp - INFO - Сообщение ID: 114 от user_id: 3 в chat_id: 7 сохранено, last_message_at обновлено (2025-05-29T23:01:33.979300+07:00).
2025-05-29 23:01:33,980 - ServerApp - INFO - Сообщение (ID: 114) от 3333 в чат 7 сохранено.
2025-05-29 23:01:33,981 - ServerApp - DEBUG - Участники чата 7 для рассылки (кроме 3 - 3333): [2]
2025-05-29 23:01:33,981 - ServerApp - INFO - Доставка сообщения (ID: 114) от 3333 участнику 2222 (ID: 2) чата 7.
2025-05-29 23:01:33,989 - ServerApp - DEBUG - Получено от 2222 (('127.0.0.1', 53058)): {"type": "request_chat_list", "payload": {}}
2025-05-29 23:01:33,989 - ServerApp - INFO - Пользователь ID 2 запросил список чатов.
2025-05-29 23:01:33,990 - ServerApp - DEBUG - Для user_id 2 найдено 4 чатов.
2025-05-29 23:01:37,946 - ServerApp - INFO - Клиент 2222 (('127.0.0.1', 53058)) отключился.
2025-05-29 23:01:37,946 - ServerApp - INFO - Клиент 2222 (('127.0.0.1', 53058)) удален из активных.
2025-05-29 23:01:37,946 - ServerApp - DEBUG - Соединение с БД для ('127.0.0.1', 53058) (пользователь: 2222) закрыто.
2025-05-29 23:01:37,946 - ServerApp - DEBUG - Ресурсы для ('127.0.0.1', 53058) (пользователь: 2222) освобождены.
2025-05-29 23:01:38,588 - ServerApp - INFO - Клиент 1111 (('127.0.0.1', 53056)) отключился.
2025-05-29 23:01:38,588 - ServerApp - INFO - Клиент 1111 (('127.0.0.1', 53056)) удален из активных.
2025-05-29 23:01:38,588 - ServerApp - DEBUG - Соединение с БД для ('127.0.0.1', 53056) (пользователь: 1111) закрыто.
2025-05-29 23:01:38,588 - ServerApp - DEBUG - Ресурсы для ('127.0.0.1', 53056) (пользователь: 1111) освобождены.
2025-05-29 23:01:39,634 - ServerApp - INFO - Клиент 3333 (('127.0.0.1', 53079)) отключился.
2025-05-29 23:01:39,634 - ServerApp - INFO - Клиент 3333 (('127.0.0.1', 53079)) удален из активных.
2025-05-29 23:01:39,634 - ServerApp - DEBUG - Соединение с БД для ('127.0.0.1', 53079) (пользователь: 3333) закрыто.
2025-05-29 23:01:39,634 - ServerApp - DEBUG - Ресурсы для ('127.0.0.1', 53079) (пользователь: 3333) освобождены.
2025-05-29 23:01:48,938 - ServerApp - INFO - Получен сигнал KeyboardInterrupt (Ctrl+C)...
2025-05-29 23:01:48,938 - ServerApp - INFO - Сервер останавливается...
2025-05-29 23:01:48,938 - ServerApp - INFO - Сервер полностью остановлен.
